% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/annotate_gwas_with_loci.R
\name{annotate_gwas_with_loci}
\alias{annotate_gwas_with_loci}
\title{Annotate GWAS Data with Genomic Loci and Identify Top SNPs}
\usage{
annotate_gwas_with_loci(
  gwas_data,
  loci_data,
  loci_name,
  p_col = NULL,
  gwas_chr_col = "CHR",
  gwas_pos_col = "BP",
  loci_chr_col = "chr",
  loci_start_col = "start",
  loci_end_col = "end",
  loci_name_col = "locusname",
  loci_pos_col = "pos"
)
}
\arguments{
\item{gwas_data}{A data.table or data.frame containing GWAS results.}

\item{loci_data}{A data.table or data.frame defining genomic loci.}

\item{loci_name}{A prefix for the new column names (e.g., "fuma8").}

\item{p_col}{Optional character string specifying the p-value column in `gwas_data` to use for
dynamically identifying the top SNP if not pre-defined in `loci_data`.}

\item{gwas_chr_col}{Column name for chromosome in `gwas_data` (default: "CHR").}

\item{gwas_pos_col}{Column name for base pair position in `gwas_data` (default: "BP").}

\item{loci_chr_col}{Column name for chromosome in `loci_data` (default: "chr").}

\item{loci_start_col}{Column name for start position in `loci_data` (default: "start").}

\item{loci_end_col}{Column name for end position in `loci_data` (default: "end").}

\item{loci_name_col}{Column name for locus name in `loci_data` (default: "locusname").}

\item{loci_pos_col}{Column name for pre-defined top SNP position in `loci_data` (default: "pos").}
}
\value{
The modified gwas_data data.table with two new columns:
  \itemize{
    \item A locus annotation column named "loci.{loci_name}" indicating which locus each SNP belongs to
    \item A top SNP flag column named "{loci_name}_topsnp" marking the top SNP in each locus
  }
}
\description{
This function annotates GWAS data with genomic loci information and identifies the top SNP for each locus.
It can use either pre-defined top SNP positions from the loci data or dynamically determine the top SNP
by finding the variant with the smallest p-value within each locus. All column names are user-specifiable.
}
\examples{
# Create example GWAS data with custom column names
gwas_data <- data.table::data.table(
  chromosome = c("1", "1", "1", "2", "2", "3"),
  position = c(110000, 120000, 510000, 760000, 770000, 220000),
  p_value = c(0.001, 0.0001, 0.01, 0.00001, 0.00005, 0.0002),
  SNP = c("rs111", "rs112", "rs113", "rs114", "rs115", "rs116")
)

# Create example loci data with custom column names
loci_data <- data.table::data.table(
  chrom = c("1", "1", "2", "3"),
  begin = c(100000, 500000, 750000, 200000),
  stop = c(150000, 550000, 800000, 250000),
  locus_id = c("LOC1", "LOC2", "LOC3", "LOC4"),
  top_position = c(120000, 520000, 770000, 220000)  # Pre-defined top SNP positions
)

# Annotate using custom column names
annotated_data <- annotate_gwas_with_loci(
  gwas_data = gwas_data,
  loci_data = loci_data,
  loci_name = "custom",
  p_col = "p_value",
  gwas_chr_col = "chromosome",
  gwas_pos_col = "position",
  loci_chr_col = "chrom",
  loci_start_col = "begin",
  loci_end_col = "stop",
  loci_name_col = "locus_id",
  loci_pos_col = "top_position"
)
print(annotated_data)

}
