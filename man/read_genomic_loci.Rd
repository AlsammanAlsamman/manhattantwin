% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/read_genomic_loci.R
\name{read_genomic_loci}
\alias{read_genomic_loci}
\title{Read Genomic Loci Definition File}
\usage{
read_genomic_loci(file_path, source = "default")
}
\arguments{
\item{file_path}{Character string. The path to the loci file.}

\item{source}{Character string. The format of the file. Options:
\itemize{
  \item "default": A simple 4-column file (chr, start, end, locusname)
  \item "fuma": A 'GenomicRiskLoci.txt' file from FUMA. This will create
      a 'locusname' column (e.g., 'fuma_1') and add 'pos' and 'topsnp'
      columns from the 'pos' and 'rsID' columns in the file.
}
Default: "default"}
}
\value{
A data.table containing the loci information with columns:
  \itemize{
    \item chr: Chromosome number
    \item start: Start position of the locus
    \item end: End position of the locus
    \item locusname: Name/identifier of the locus
    \item pos: (For FUMA source) Position of the top SNP
    \item topsnp: (For FUMA source) rsID of the top SNP
  }
}
\description{
This function reads a file containing genomic loci definitions from different sources
(e.g., simple format or FUMA) and standardizes the output into a consistent format.
It efficiently handles large files using data.table for fast reading.
}
\examples{
# Example for default format
default_loci_data <- data.table::data.table(
  chr = c("1", "1", "2", "3", "5"),
  start = c(100000, 500000, 750000, 200000, 300000),
  end = c(150000, 550000, 800000, 250000, 350000),
  locusname = c("LOC1", "LOC2", "LOC3", "LOC4", "LOC5")
)

default_file <- tempfile(fileext = ".txt")
data.table::fwrite(default_loci_data, file = default_file, sep = "\t", quote = FALSE)
default_result <- read_genomic_loci(default_file, source = "default")
print(default_result)

# Example for FUMA format
fuma_loci_data <- data.table::data.table(
  GenomicLocus = c(1, 2, 3, 4, 5),
  rsID = c("rs12345", "rs67890", "rs11111", "rs22222", "rs33333"),
  pos = c(120000, 520000, 770000, 220000, 320000),
  chr = c("1", "1", "2", "3", "5"),
  start = c(100000, 500000, 750000, 200000, 300000),
  end = c(150000, 550000, 800000, 250000, 350000)
)

fuma_file <- tempfile(fileext = ".txt")
data.table::fwrite(fuma_loci_data, file = fuma_file, sep = "\t", quote = FALSE)
fuma_result <- read_genomic_loci(fuma_file, source = "fuma")
print(fuma_result)

}
